---
title: "How to setup a git repository with code, webpage and R/Binder docker" 
author: "Lieven Clement"
date: "statOmics, Ghent University (https://statomics.github.io)"
output:
    html_document:
      code_download: true    
      theme: cosmo
      toc: true
      toc_float: true
      highlight: tango
      number_sections: true
---

# Setup new repository
## Setup repository on github webpage

- Go to [GitHub](https://github.com)
- Log in to your account.
- Click the new repository button in the top-right. 
- You have an option to initialize a repository with a README file. But I do that from the command line so I do not select this option. 
- Just hit the "Create repository" button.

## Setup github repository locally

- Go to the directory where you save your github repostories
- Copy the location from the clone/download button of the repository on the github webpage here it is `git clone git@github.com:statOmics/dockerPageExample.git`
- Type `git clone git@github.com:statOmics/dockerPageExample.git`
- Write some code.
- Type `git add .` to add the files (see the typical use page).
- Type `git commit -m "first commit"` to commit your your changes to github. The -m flag is used to add the message "first commit" to indicate the changes that you add
- Type `git push origin` to add the files to your github account

# Add webpage
## Initialize Webpage
- You can add a webpage from a directory in the master branch, but I prefer to do it in a separate gh-pages branch 

- Type `git checkout --orphan gh-pages` to create a new gh-pages branch.

- I typically delete everything and copy the website from another repository. I use the template on https://github.com/GTPB/Web_course_template. So I download the repository and unzip it in my download folder and copy it to the gh-pages branch that is now open in my locale git repository

```
cp -r ~/Downloads/Web_course_template-master/* .
```

## Adjust licence file

## Adjust index file

## Adjust _config.yml

## Adjust default.html in themes>twitter 

## Push inital webpage to github

- Enter `git add .`
- Enter `git commit -m "gh-pages initialized"`
- Enter `git push origin gh-pages`
- As soon as a gh-pages branch is pushed, your webpage is automatically visible. You can check this in the settings tab of your github repository:
[https://github.com/statOmics/dockerPageExample/settings](https://github.com/statOmics/dockerPageExample/settings)

# Setup online Rstudio via R/binder 
## Add runtime.txt file
When adding a runtime.txt file with an R timestamped version, R will be automatically installed. 
Here we will add R 3.6. 

```
echo r-3.6-2019-04-12 >> runtime.txt
```

## Add install.R file with all scripts

If your R version is time stamped, all packages that are installed from bioconductor will be timestamped. 

In the install.R file we first install the biocManager package and then use the biocInstall function to install all other packages.

```
install.packages("BiocManager")
BiocManager::install("tidyverse")
BiocManager::install("NHANES")
```

## Activate Binder

- Go to mybinder webpage to activate binder link: [https://mybinder.org](https://mybinder.org)

- Enter repository name 

- Hit launch button

## Binder link

- You can now add a link to the binder instance on your webpage. Structure of link

      - Copy the link of binder with repo name and repo branch: 
`https://mybinder.org/v2/gh/statomics/dockerPageExample/master`  
      - add `?urlpath=rstudio` to launch R studio. 

- So full link with binder logo is included here: 
`[![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/statomics/dockerPageExample/master?urlpath=rstudio)`

# Run scripts in binder: 

- Launch binder and run your scripts
- Download webpages in local github repo 
- push changes to github repo
- Checkout to gh-pages branch

```
git checkout gh-pages
```

- Copy the markdown files and the html files from the directory rmarkdown files in the master

```
git checkout master rmarkdownScripts/**
```

Add html files to webpage and you are all set. 

# local Docker instance
## Generate local docker instance
You can install your own local docker by downloading the entire master branch or the branch with the docker from the github repository and invoking in a console:

```
docker build <path to proteomicsShortCourse directory> -t myRepo_docker
```

This only has to be done once and generates a container that is always exactly alike.

## Launch docker

1. Open a terminal
2. Launch the docker by typing the command

```
sudo docker run -p 8888:8888 myRepo_docker
```



